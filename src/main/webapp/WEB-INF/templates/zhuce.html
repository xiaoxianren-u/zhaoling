<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
          name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <link rel="stylesheet" th:href="@{/static/css/layui.css}">
    <script th:src="@{/static/js/jquery-3.5.1.min_2.js}"></script>
    <script th:src="@{/static/js/jquery.cookie.js}"></script>
    <script th:src="@{/static/js/cookie.js}"></script>
    <script th:src="@{/static/js/layui.js}"></script>
    <script th:src="@{static/js/md5.js}"></script>
    <link rel="stylesheet" th:href="@{/static/icon_1/iconfont.css}">
    <link rel="stylesheet" th:href="@{/static/css/modules/layer/default/layer.css}">
    <link rel="stylesheet" th:href="@{/static/css/modules/code.css}">
    <link rel="stylesheet" th:href="@{/static/css/modules/laydate/default/laydate.css}">
    <link rel="icon" th:href="@{/static/image/zl.png}" type="image/x-icon"/>
    <style type="text/css">
        body {
            background-size: cover;
            /*background-color: white;*/
            background: url("../../static/image/b.png") no-repeat center;
        }

        #home {
            width: 17%;
            height: 350px;
            margin-left: 66%;
            margin-top: 8%;
            color: #479b9b;
            background-color: white;
            border-radius: 10px;
            /*filter: alpha(opacity=30);*/
            /*opacity: 0.8;*/
            /*-moz-opacity: 0.8;;*/
        }


        .inp {
            width: 100%;
            line-height: 40px;
            margin: 10px 0;
            font-size: 20px;
            border: 1px solid #13c9a3;

            border-radius: 8px;
        }

        #disable {
            border: 1px solid red;
        }

        #username, #password {
            text-indent: 1.5em;
        }

        #btn {
            background: #979898;
            border: 1px #979898 solid;
        }

        #hone {
            /*width: 55%;*/
            text-indent: 1.5em;
        }

        #btn:hover {
            cursor: pointer;
            border: 1px #13c9a3 solid;
            background: #13c9a3;
            color: white;
        }

        #img {
            float: right;
            margin-top: 13px;
            width: 100px;
            height: 35px;
            border-radius: 10px;
            border: 1px #13c9a3 solid;
        }

        #img:hover {
            cursor: pointer;
        }
    </style>

    <title>招领注册</title>
</head>
<body>

<div style="height: 900px;color: white;">
    <!--    sdf-->
    <div style="height: 700px;z-index: 1;position:absolute;left: 0;right: 0;top: 110px">

        <div style="position:absolute; z-index: 10; top:-40px;left:250px;color: red;">
            <div style="FONT-SIZE: 30pt; FILTER: dropshadow(color=#228B22,offX=5,offY=3,Positive=1);
                        WIDTH: 100%; color: #1E9FFF; LINE-HEIGHT: 150%; FONT-FAMILY: 华文行楷"><strong>
                <img height="50" style="border-radius: 50%" th:src="@{/static/image/zl.png}" width="50"/>招领网</strong>
            </div>
        </div>
        <div style="position:absolute; z-index: 10; top:-20px;left:1200px;color: red;">
            <samp style="padding-left: 1.5em;color: black"><a href="/">招领网官网</a>&nbsp;|&nbsp;<a
                    href="javascript:">QQ资讯</a>&nbsp;|&nbsp;<a href="javascript:">帮助中心</a>&nbsp;|</samp>
        </div>

        <div style="position:absolute; z-index: 10; top:160px;left:250px;color: white;">
            <p style="font-size: 38px;font-weight: bold;line-height: 2.5em;">你的物品、我来找</p>
            <p style="font-size: 35px;line-height: 2.2em;">你的到来、是我坚持的动力</p>
            <p style="font-size: 35px;line-height: 2.2em;">小招、欢迎你</p>
        </div>
        <div style="position:absolute; z-index: 10; top:700px;left:700px;color: red;">
            <div style="height: 40px;text-align: center;font-size: 12px;color: #b6bac3;margin-top: 10px">
                <span style="line-height: 3em; color: #666;">电话:&nbsp;400-629-9999&nbsp;&nbsp;&nbsp;&nbsp;邮箱:&nbsp;1793925141@qq.com</span><br>
                ©2021 Lost and found | 服务协议 | 权利声明 | 版本更新 | 帮助中心 | 版权投诉 | 招领系统开发小组所有
            </div>
        </div>

        <div id="home" style="position:absolute; z-index: 10; top:0;left:0;">
            <div class="layui-row">
                <div class="layui-col-xs6" style="margin-top: 20px;">
                    <div class="grid-demo grid-demo-bg1"><span style="font-size: 20px;margin-left: 20px">账号注册</span>
                    </div>
                </div>
                <div class="layui-col-xs6">
                    <div class="grid-demo" style="">
                        <div style="margin-top: 25px"><span>已有账号? <a href="/login">点此登录</a></span></div>
                    </div>
                </div>
            </div>
            <div class="layui-row" style="padding-top: 30px;">
                <div class="layui-col-xs1">
                    <div class="grid-demo grid-demo-bg1" style="color:white;">.</div>
                </div>
                <div class="layui-col-xs10">
                    <div class="grid-demo">
                        <form action="login" id="myForm" method="post">
                            <i class="iconfont icon-yonghuming"
                               style="font-size: 20px; color:#13c9a3; z-index: 999999;position:absolute;top: 20px;left: 6px; "></i>
                            <input class="inp" id="username" name="username" placeholder="输入用户名" type="text" value=""/>
                            <i class="iconfont icon-mima"
                               style="font-size: 20px; color: #13c9a3;z-index: 999999;position:absolute;top: 82px;left: 6px; "></i>
                            <input class="inp" id="password" name="password" placeholder="输入密码" type="password"
                                   value=""/>

                            <i class="iconfont icon-top_lianxifangshi"
                               style="font-size: 20px; color: #13c9a3;z-index: 999999;position:absolute;top: 145px;left: 6px; "></i>
                            <input class="inp" id="hone" placeholder="11位联系方式" type="text"/>
                            <!--                            <img id="img" onclick="changeImg()" src="getCode">-->

                            <!--                            <div style="margin: 10px;">-->
                            <!--                        <span><input id="rememberMe" style="margin-right: 5px;margin-top: 3px" type="checkbox"><label-->
                            <!--                                for="rememberMe">记住密码</label></span>-->
                            <!--                                &lt;!&ndash;                            <span style="font-size: 2pt;color: #bbb;">不是自己的电脑上不要勾选此项</span>&ndash;&gt;-->
                            <!--                                <span style="float: right;"><input id="autoLogin" style="margin-right: 5px;"-->
                            <!--                                                                   type="checkbox"><label-->
                            <!--                                        for="autoLogin">一周内免登录</label></span>-->
                            <!--                            </div>-->
                            <button class="inp" id="btn" type="button">注册</button>
                        </form>
                        <!--                        <div>-->
                        <!--                            <span><a href="http://www.baidu.com" style="float: left;color: #1E9FFF">注册?</a></span>-->
                        <!--                            <span><a href="#" style="float: right;color: #1E9FFF;">忘记密码?</a></span>-->
                        <!--                        </div>-->
                    </div>
                </div>
                <div class="layui-col-xs1">
                    <div class="grid-demo" style="color:white;">6/12</div>
                </div>
            </div>

        </div>
    </div>


    <div style="width: 100%;height: 900px">
        <canvas height="" id="cas" style="z-index: -1;position:absolute;" width=""></canvas>
    </div>

    <!--    <div style="background-color: white;height: 140px;width: 100%;position: absolute;z-index: 9999999;top: 0;left: 0">-->
    <!--                sdfsdfhsdjkfhkshfkshfjkshdjkfhskjdhf-->
    <!--    </div>-->
    <!--    <div style="background-color: white;height: 20%;width: 100%;position: absolute;z-index: 9999999;top: 760px;left: 0">-->
    <!--        sdfsdfhsdjkfhkshfkshfjkshdjkfhskjdhf-->
    <!--    </div>-->
</div>
<!--验证码实现-->


<!--实现颗粒线背景-->
<script>
    var canvas = document.getElementById("cas");
    var ctx = canvas.getContext("2d");

    resize();
    window.onresize = resize;

    function resize() {
        canvas.width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
        canvas.height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
    }

    var RAF = (function () {
        return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {
            window.setTimeout(callback, 1000 / 60);
        };
    })();

    // 鼠标活动时，获取鼠标坐标
    var warea = {x: null, y: null, max: 20000};
    window.onmousemove = function (e) {
        e = e || window.event;

        warea.x = e.clientX;
        warea.y = e.clientY;
    };
    window.onmouseout = function (e) {
        warea.x = null;
        warea.y = null;
    };

    // 添加粒子
    // x，y为粒子坐标，xa, ya为粒子xy轴加速度，max为连线的最大距离
    var dots = [];
    for (var i = 0; i < 450; i++) {
        var x = Math.random() * canvas.width;
        var y = Math.random() * canvas.height;
        var xa = Math.random() * 2 - 1;
        var ya = Math.random() * 2 - 1;

        dots.push({
            x: x,
            y: y,
            xa: xa,
            ya: ya,
            max: 7000
        })
    }

    // 延迟100秒开始执行动画，如果立即执行有时位置计算会出错
    setTimeout(function () {
        animate();
    }, 100);

    // 每一帧循环的逻辑
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // 将鼠标坐标添加进去，产生一个用于比对距离的点数组
        var ndots = [warea].concat(dots);
        dots.forEach(function (dot) {
            // 粒子位移
            dot.x += dot.xa;
            dot.y += dot.ya;
            // 遇到边界将加速度反向
            dot.xa *= (dot.x > canvas.width || dot.x < 0) ? -1 : 1;
            dot.ya *= (dot.y > canvas.height || dot.y < 0) ? -1 : 1;
            // 绘制点
            ctx.fillRect(dot.x - 0.5, dot.y - 0.5, 1, 1);
            // 循环比对粒子间的距离
            for (var i = 0; i < ndots.length; i++) {
                var d2 = ndots[i];
                if (dot === d2 || d2.x === null || d2.y === null) continue;
                var xc = dot.x - d2.x;
                var yc = dot.y - d2.y;
                // 两个粒子之间的距离
                var dis = xc * xc + yc * yc;
                // 距离比
                var ratio;
                // 如果两个粒子之间的距离小于粒子对象的max值，则在两个粒子间画线
                if (dis < d2.max) {
                    // 如果是鼠标，则让粒子向鼠标的位置移动
                    if (d2 === warea && dis > (d2.max / 2)) {
                        dot.x -= xc * 0.03;
                        dot.y -= yc * 0.03;
                    }
                    // 计算距离比
                    ratio = (d2.max - dis) / d2.max;
                    // 画线
                    ctx.beginPath();
                    ctx.lineWidth = ratio / 2;
                    //线条颜色
                    ctx.strokeStyle = 'rgba(255,255,255,' + (ratio + 0.3) + ')';
                    ctx.moveTo(dot.x, dot.y);
                    ctx.lineTo(d2.x, d2.y);
                    ctx.stroke();
                }
            }
            // 将已经计算过的粒子从数组中删除
            ndots.splice(ndots.indexOf(dot), 1);
        });
        RAF(animate);
    }
</script>

<!--检测Cookie是否打开-->
<script>
    function CookieEnable() {
        var result = false;
        if (navigator.cookiesEnabled) return true;
        document.cookie = "testcookie=yes;";
        var cookieSet = document.cookie;
        if (cookieSet.indexOf("testcookie=yes") > -1) result = true;
        document.cookie = "";
        return result;
    }

    if (!CookieEnable()) {
        alert("检测您的浏览器Cookie已经关闭，您将可能无法正常使用该网站，请到设置中打开Cookie")
    }
</script>

<script th:inline="none">


    layui.use(function () {


        let a = 0;

        $('#username').blur(function () {
            let username = $("#username").val();
            if (username === '') {
                layer.msg('用户名不能为空！！');

                return false;
            }
            console.log("===================")
            if (username.length < 8) {
                layer.msg('用户名不能少于8位！！');
                return false;
            }
            a = 1;
        })

        let b = 0;
        $('#password').blur(function () {
            let password = $("#password").val();
            if (password === '') {
                layer.msg('密码不能为空！！');
                return false;
            }
            if (password.length < 8) {
                layer.msg('密码不能少于8位！！');
                return false;
            }
            if (password.indexOf(" ") === -1) {
                b = 1;
            } else {
                layer.msg('密码不能有空格！！');
                return false;
            }
        })
        let c = 0;
        $("#hone").blur(function () {
            let user_iphone = $('#hone').val();
            console.log(user_iphone);
            if (user_iphone === '') {
                layer.msg('联系方式不能为空！！');
                return false;
            }
            if (!(/^1[3456789]\d{9}$/.test(user_iphone))) {
                layer.msg('联系方式不符合！！');
                return false;
            }
            c = 1;
        })


        $('#btn').click(function () {


            console.log({a: a, b: b, c: c});
            if (a === 1 && b === 1 && c === 1) {
                let username = $("#username").val();
                let user_iphone = $('#hone').val();
                let password = $("#password").val();

                console.log({user_name: username, pass_word: password, user_iphone: user_iphone});
                const yan = '!a@n%p&';
                password = md5(yan + password + yan);
                $.ajax({
                    type: "POST",
                    url: "/register",
                    async: true,
                    data: JSON.stringify({user_name: username, pass_word: password, user_iphone: user_iphone}),
                    dataType: "json",
                    contentType: "application/json;charset=UTF-8",
                    success: function (src) {

                        if (src.bool) {
                            a = 0;
                            b = 0;
                            c = 0;
                            $("#username").val('');
                            $("#password").val('');
                            $("#hone").val('');
                            layer.msg(src.msg);

                        } else {
                            layer.msg(src.msg, {icon: 5});
                        }
                        console.log(src);
                    }
                })
            } else {
                layer.msg('请按要求填写！！');
            }


        })

    })


</script>

</body>
</html>
